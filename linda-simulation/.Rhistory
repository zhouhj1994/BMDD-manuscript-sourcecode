par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
combine.fun <- function(setup, output, s) {
if(s == 4) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
} else {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
}
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 10) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
########################################
plot.power.fun <- function(output, s){
l <- nrow(output) /  2
means <- output[1 : l, ]
errors <- output[(l + 1) : (2 * l), ]
rownames(means) <- c("LinDA", "LinDA-BMDD", "LinDA-SAVER")
colnames(means) <- c("m=50;n=50", "m=200;n=50", "m=500;n=50",
"m=50;n=200", "m=200;n=200", "m=500;n=200")
bar_positions <- barplot(means, beside = TRUE,
col = c("lightgrey", "lightcoral", "lightblue"),
xlab = 'True Positive Rate',
horiz = TRUE,
xlim = c(0, max(means + errors) + 0.1),
yaxt = "n",
cex.axis = 1.2, cex.lab = 1.2)
for (i in 1:nrow(means)) {
arrows(means[i, ] - 1.96*errors[i, ],
bar_positions[i, ],
means[i, ] + 1.96*errors[i, ],
bar_positions[i, ],
angle = 90,
code = 3,
length = 0.1)
}
if (s == 4) {
legend("right", legend = rownames(means),
fill = c("lightgrey", "lightcoral", "lightblue"),
cex = 1.2,  # Adjust text size
bty = "n",  # No box around the legend
inset = c(-0.2, -0.2), # Horizontal, vertical movement
xpd = TRU)
}
}
combine.fun <- function(setup, output, s) {
if(s == 4) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
} else {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
}
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
########################################
plot.power.fun <- function(output, s){
l <- nrow(output) /  2
means <- output[1 : l, ]
errors <- output[(l + 1) : (2 * l), ]
rownames(means) <- c("LinDA", "LinDA-BMDD", "LinDA-SAVER")
colnames(means) <- c("m=50;n=50", "m=200;n=50", "m=500;n=50",
"m=50;n=200", "m=200;n=200", "m=500;n=200")
bar_positions <- barplot(means, beside = TRUE,
col = c("lightgrey", "lightcoral", "lightblue"),
xlab = 'True Positive Rate',
horiz = TRUE,
xlim = c(0, max(means + errors) + 0.1),
yaxt = "n",
cex.axis = 1.2, cex.lab = 1.2)
for (i in 1:nrow(means)) {
arrows(means[i, ] - 1.96*errors[i, ],
bar_positions[i, ],
means[i, ] + 1.96*errors[i, ],
bar_positions[i, ],
angle = 90,
code = 3,
length = 0.1)
}
if (s == 4) {
legend("right", legend = rownames(means),
fill = c("lightgrey", "lightcoral", "lightblue"),
cex = 1.2,  # Adjust text size
bty = "n",  # No box around the legend
inset = c(-0.2, -0.2), # Horizontal, vertical movement
xpd = TRUE)
}
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
combine.fun <- function(setup, output, s) {
if(s == 4) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 12, height = 8)
} else {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
}
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
combine.fun <- function(setup, output, s) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 5) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
combine.fun <- function(setup, output, s) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 4) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
########################################
plot.power.fun <- function(output, s){
l <- nrow(output) /  2
means <- output[1 : l, ]
errors <- output[(l + 1) : (2 * l), ]
rownames(means) <- c("LinDA", "LinDA-BMDD", "LinDA-SAVER")
colnames(means) <- c("m=50;n=50", "m=200;n=50", "m=500;n=50",
"m=50;n=200", "m=200;n=200", "m=500;n=200")
bar_positions <- barplot(means, beside = TRUE,
col = c("lightgrey", "lightcoral", "lightblue"),
xlab = 'True Positive Rate',
horiz = TRUE,
xlim = c(0, max(means + errors) + 0.1),
yaxt = "n",
cex.axis = 1.2, cex.lab = 1.2)
for (i in 1:nrow(means)) {
arrows(means[i, ] - 1.96*errors[i, ],
bar_positions[i, ],
means[i, ] + 1.96*errors[i, ],
bar_positions[i, ],
angle = 90,
code = 3,
length = 0.1)
}
if (s == 4) {
legend("right", legend = rownames(means),
fill = c("lightgrey", "lightcoral", "lightblue"),
cex = 1.2,  # Adjust text size
bty = "n",  # No box around the legend
inset = c(0, 0), # Horizontal, vertical movement
xpd = TRUE)
}
}
combine.fun <- function(setup, output, s) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
########################################
plot.power.fun <- function(output, s){
l <- nrow(output) /  2
means <- output[1 : l, ]
errors <- output[(l + 1) : (2 * l), ]
rownames(means) <- c("LinDA", "LinDA-BMDD", "LinDA-SAVER")
colnames(means) <- c("m=50;n=50", "m=200;n=50", "m=500;n=50",
"m=50;n=200", "m=200;n=200", "m=500;n=200")
bar_positions <- barplot(means, beside = TRUE,
col = c("lightgrey", "lightcoral", "lightblue"),
xlab = 'True Positive Rate',
horiz = TRUE,
xlim = c(0, max(means + errors) + 0.1),
yaxt = "n",
cex.axis = 1.2, cex.lab = 1.2)
for (i in 1:nrow(means)) {
arrows(means[i, ] - 1.96*errors[i, ],
bar_positions[i, ],
means[i, ] + 1.96*errors[i, ],
bar_positions[i, ],
angle = 90,
code = 3,
length = 0.1)
}
if (s == 4) {
legend("right", legend = rownames(means),
fill = c("lightgrey", "lightcoral", "lightblue"),
cex = 1.2,  # Adjust text size
bty = "n",  # No box around the legend
inset = c(-0.4, -0.4), # Horizontal, vertical movement
xpd = TRUE)
}
}
combine.fun <- function(setup, output, s) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 4) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
########################################
plot.power.fun <- function(output, s){
l <- nrow(output) /  2
means <- output[1 : l, ]
errors <- output[(l + 1) : (2 * l), ]
rownames(means) <- c("LinDA", "LinDA-BMDD", "LinDA-SAVER")
colnames(means) <- c("m=50;n=50", "m=200;n=50", "m=500;n=50",
"m=50;n=200", "m=200;n=200", "m=500;n=200")
bar_positions <- barplot(means, beside = TRUE,
col = c("lightgrey", "lightcoral", "lightblue"),
xlab = 'True Positive Rate',
horiz = TRUE,
xlim = c(0, max(means + errors) + 0.1),
yaxt = "n",
cex.axis = 1.2, cex.lab = 1.2)
for (i in 1:nrow(means)) {
arrows(means[i, ] - 1.96*errors[i, ],
bar_positions[i, ],
means[i, ] + 1.96*errors[i, ],
bar_positions[i, ],
angle = 90,
code = 3,
length = 0.1)
}
if (s == 4) {
legend("right", legend = rownames(means),
fill = c("lightgrey", "lightcoral", "lightblue"),
cex = 1.2,  # Adjust text size
bty = "n",  # No box around the legend
inset = c(-0.3, -0.3))
}
}
combine.fun <- function(setup, output, s) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 4) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
########################################
plot.power.fun <- function(output, s){
l <- nrow(output) /  2
means <- output[1 : l, ]
errors <- output[(l + 1) : (2 * l), ]
rownames(means) <- c("LinDA", "LinDA-BMDD", "LinDA-SAVER")
colnames(means) <- c("m=50;n=50", "m=200;n=50", "m=500;n=50",
"m=50;n=200", "m=200;n=200", "m=500;n=200")
bar_positions <- barplot(means, beside = TRUE,
col = c("lightgrey", "lightcoral", "lightblue"),
xlab = 'True Positive Rate',
horiz = TRUE,
xlim = c(0, max(means + errors) + 0.1),
yaxt = "n",
cex.axis = 1.2, cex.lab = 1.2)
for (i in 1:nrow(means)) {
arrows(means[i, ] - 1.96*errors[i, ],
bar_positions[i, ],
means[i, ] + 1.96*errors[i, ],
bar_positions[i, ],
angle = 90,
code = 3,
length = 0.1)
}
if (s == 4) {
legend("right", legend = rownames(means),
fill = c("lightgrey", "lightcoral", "lightblue"),
cex = 1.2,  # Adjust text size
bty = "n",  # No box around the legend
inset = c(-0.3, -0.3), # Horizontal, vertical movement
xpd = TRUE)
}
}
combine.fun <- function(setup, output, s) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 4) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
combine.fun <- function(setup, output, s) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 5) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
########################################
plot.power.fun <- function(output, s){
l <- nrow(output) /  2
means <- output[1 : l, ]
errors <- output[(l + 1) : (2 * l), ]
rownames(means) <- c("LinDA", "LinDA-BMDD", "LinDA-SAVER")
colnames(means) <- c("m=50;n=50", "m=200;n=50", "m=500;n=50",
"m=50;n=200", "m=200;n=200", "m=500;n=200")
bar_positions <- barplot(means, beside = TRUE,
col = c("lightgrey", "lightcoral", "lightblue"),
xlab = 'True Positive Rate',
horiz = TRUE,
xlim = c(0, max(means + errors) + 0.1),
yaxt = "n",
cex.axis = 1.2, cex.lab = 1.2)
for (i in 1:nrow(means)) {
arrows(means[i, ] - 1.96*errors[i, ],
bar_positions[i, ],
means[i, ] + 1.96*errors[i, ],
bar_positions[i, ],
angle = 90,
code = 3,
length = 0.1)
}
if (s == 4) {
legend("right", legend = rownames(means),
fill = c("lightgrey", "lightcoral", "lightblue"),
cex = 1.2,  # Adjust text size
bty = "n",  # No box around the legend
inset = c(-0.4, -0.4), # Horizontal, vertical movement
xpd = TRUE)
}
}
combine.fun <- function(setup, output, s) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 6) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
combine.fun <- function(setup, output, s) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 8) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
combine.fun <- function(setup, output, s) {
if(s == 4) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 13, height = 8)
} else {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
}
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 8) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
combine.fun <- function(setup, output, s) {
if(s == 4) {
pdf(paste0(setup, '_barplot_2.pdf'), width = 13, height = 8)
} else {
pdf(paste0(setup, '_barplot_2.pdf'), width = 11, height = 8)
}
par(mfrow = c(1, 2))
par(mar = c(5, 4, 4-2, 2-1) + 0.1)
plot.fdr.fun(output[c(1 : 3 , 7 : 9), ])
if(s == 4) {
par(mar = c(5, 4-3, 4-2, 10) + 0.1)
} else {
par(mar = c(5, 4-3, 4-2, 2) + 0.1)
}
plot.power.fun(output[c(4 : 6 , 10 : 12), ], s)
dev.off()
}
setup <- 'S4'
output <- output4
combine.fun(setup, output, 4)
filenames <- list.files("output")
library(foreach)
res <- foreach (j = 1 : n.shuf, .combine = 'rbind') %do% {
pval.mat.list <- readRDS(paste0("output/", filenames[j]))
aa <- NULL
for(i in 1 : 4) {
aa <- append(aa, colSums(is.na(pval.mat.list[[i]][, c(2, 4, 6)])) > 0)
}
aa
}
n.shuf=100
filenames <- list.files("output")
library(foreach)
res <- foreach (j = 1 : n.shuf, .combine = 'rbind') %do% {
pval.mat.list <- readRDS(paste0("output/", filenames[j]))
aa <- NULL
for(i in 1 : 4) {
aa <- append(aa, colSums(is.na(pval.mat.list[[i]][, c(2, 4, 6)])) > 0)
}
aa
}
j=1
pval.mat.list <- readRDS(paste0("output/", filenames[j]))
filenames <- list.files("output")
library(foreach)
pval.mat.list <- readRDS(paste0("output/", filenames[j]))
filenames
